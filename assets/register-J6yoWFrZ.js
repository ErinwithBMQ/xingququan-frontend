import{r as n,j as e,b as c,c as x,a as f}from"./index-D0tWTQow.js";import{a as g}from"./axios.config-BNfgfF5-.js";function j(){const[r,d]=n.useState(""),[a,m]=n.useState(""),[o,p]=n.useState(null),u=s=>{p(s.target.files[0])},h=async s=>{if(s.preventDefault(),!r||!a){alert("用户名和密码不得为空！");return}if(!o){alert("请上传头像");return}try{const t=await c.get("http://127.0.0.1:7001/user/find_user",{params:{name:r}});if(console.log("检测是否有用户"),t.data!==!1){console.log(t.data,"用户已存在"),alert("用户已存在。请更换用户名。");return}}catch(t){console.error(t),alert("创建失败。出现问题。")}const l=new FormData;o&&l.append("file",o);let i=0;try{i=(await g.post("/file/upload",l,{headers:{"Content-Type":"multipart/form-data"}})).data,console.log("图片上传成功")}catch(t){console.error("Error:",t)}try{const t=await c.post("http://127.0.0.1:7001/user/create_user",{name:r,secret:a,photo_id:i});console.log(t.data.name,"用户成功创建"),alert("你已经成功创建用户!"),window.location.href="/login.html"}catch(t){console.error(t),alert("创建失败。")}};return e.jsx("div",{children:e.jsxs("div",{className:"shell",children:[e.jsxs("form",{onSubmit:h,children:[e.jsx("h2",{className:"title",children:"Register"}),e.jsx("input",{type:"text",id:"username",placeholder:"Username",value:r,onChange:s=>d(s.target.value)}),e.jsx("input",{type:"password",id:"password",placeholder:"Password",value:a,onChange:s=>m(s.target.value)}),e.jsxs("div",{className:"flex mt-4",children:[e.jsx("input",{type:"file",onChange:u,className:"pb-4"}),e.jsx("div",{className:"text-xl font-semibold text-purple-400",children:"上传头像"})]}),e.jsx("input",{type:"submit",value:"Register",id:"registerBtn"})]}),e.jsxs("div",{className:"footer",children:[e.jsx("div",{className:"Remember"}),e.jsx("button",{id:"Password",onClick:()=>window.location.href="/login.html",children:"去登录"})]})]})})}x.createRoot(document.getElementById("root")).render(e.jsx(f.StrictMode,{children:e.jsx("div",{children:e.jsx(j,{})})}));
