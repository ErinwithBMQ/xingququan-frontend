import{r as o,j as e,b as d,c as g,a as j}from"./index-D0tWTQow.js";import{a as v}from"./axios.config-CAifyotM.js";function w(){const[r,p]=o.useState(""),[a,u]=o.useState(""),[l,m]=o.useState(""),[n,h]=o.useState(null),x=s=>{h(s.target.files[0])},f=async s=>{if(s.preventDefault(),!r||!a){alert("用户名和密码不得为空！");return}if(!n){alert("请上传头像");return}if(a!==l){alert("两次输入的密码不一致");return}try{const t=await d.get("http://47.99.174.164:7001/user/find_user",{params:{name:r}});if(console.log("检测是否有用户"),t.data!==!1){console.log(t.data,"用户已存在"),alert("用户已存在。请更换用户名。");return}}catch(t){console.error(t),alert("创建失败。出现问题。")}const i=new FormData;n&&i.append("file",n);let c=0;try{c=(await v.post("/file/upload",i,{headers:{"Content-Type":"multipart/form-data"}})).data,console.log("图片上传成功")}catch(t){console.error("Error:",t)}try{const t=await d.post("http://47.99.174.164:7001/user/create_user",{name:r,secret:a,photo_id:c});console.log(t.data.name,"用户成功创建"),alert("你已经成功创建用户!"),window.location.href="/login.html"}catch(t){console.error(t),alert("创建失败。")}};return e.jsx("div",{children:e.jsxs("div",{className:"shell",children:[e.jsxs("form",{onSubmit:f,children:[e.jsx("h2",{className:"title",children:"Register"}),e.jsx("input",{type:"text",id:"username",placeholder:"Username",value:r,onChange:s=>p(s.target.value)}),e.jsx("input",{type:"password",id:"password",placeholder:"Password",value:a,onChange:s=>u(s.target.value)}),e.jsx("input",{type:"password",id:"password",placeholder:"再次确认密码",value:l,onChange:s=>m(s.target.value)}),e.jsxs("div",{className:"flex mt-4",children:[e.jsx("input",{type:"file",onChange:x,className:"pb-4"}),e.jsx("div",{className:"text-xl font-semibold text-purple-400",children:"上传头像"})]}),e.jsx("input",{type:"submit",value:"Register",id:"registerBtn"})]}),e.jsxs("div",{className:"footer",children:[e.jsx("div",{className:"Remember"}),e.jsx("button",{id:"Password",onClick:()=>window.location.href="/login.html",children:"去登录"})]})]})})}g.createRoot(document.getElementById("root")).render(e.jsx(j.StrictMode,{children:e.jsx("div",{children:e.jsx(w,{})})}));
